
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>原子字符串API: &#8212; Documentation for shared_atomic</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ctypes API 參考" href="CTYPES_API.html" />
    <link rel="prev" title="原子集合API:" href="%E5%8E%9F%E5%AD%90%E9%9B%86%E5%90%88API.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="%E5%8E%9F%E5%AD%90%E9%9B%86%E5%90%88API.html" title="Previous document">原子集合API:</a>
        </li>
        <li>
          <a href="CTYPES_API.html" title="Next document">ctypes API 參考</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <div class="tex2jax_ignore mathjax_ignore section" id="api">
<h1>原子字符串API:<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h1>
<p><big>模塊atomic_string</big></p>
<span class="target" id="module-shared_atomic.atomic_string"></span><dl class="py class">
<dt class="sig sig-object py" id="shared_atomic.atomic_string.atomic_string">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">shared_atomic.atomic_string.</span></span><span class="sig-name descname"><span class="pre">atomic_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'singleprocessing'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paddingdirection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paddingstr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'</span> <span class="pre">'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trimming_direction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'utf-8'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shared_atomic.atomic_string.atomic_string" title="Permalink to this definition">¶</a></dt>
<dd><p>string provide atomic operations, the string should be no longer than 8 bytes</p>
<p>constructor to initialize the string,
the string should be no longer than 8 bytes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial</strong> – initial value of the string, if the initial value is longer than 8 bytes, please specify the trimming target length, or else it would fail.</p></li>
<li><p><strong>mode</strong> – the mode in which the string will be shared. ‘singleprocessing’ or ‘s’ for single process, ‘multiprocessing’ or ‘m’ for multiprocessing, on windows platform, only singleprocessing is supported, setting it to ‘m’ or ‘multiprocessing’ will be ignored.</p></li>
<li><p><strong>length</strong> – the expected length after padding/trimming for the input value, if not specified, no padding or trimming performed, use original value.</p></li>
<li><p><strong>paddingdirection</strong> – right, or left side the padding bytes would be added if not specified, pad to the right side, use ‘right’ or ‘r’ to specify right side, use ‘left’ or ‘l’ to specify the left side.</p></li>
<li><p><strong>paddingstr</strong> – string to pad to the original bytes, by default ‘\0’ can be multiple bytes like b’ab’, will be padded to the original bytes in circulation until the expected length is reached.</p></li>
<li><p><strong>trimming_direction</strong> – if initial bytes are longer, on which side the bytes will be trimmed. By default, on the right side, use ‘right’ or ‘r’ to specify right side, use ‘left’ or ‘l’ to specify the left side.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="shared_atomic.atomic_string.atomic_string.change_mode">
<span class="sig-name descname"><span class="pre">change_mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">newmode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'m'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shared_atomic.atomic_string.atomic_string.change_mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Switch between singleprocessing mode and multiprocessing mode,
the function doesn’t exists on windows, since only single processing mode
is supported on windows platform.
the contents will be copied , other threads/processes would not be aware of the change.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>newmode</strong> – the mode to change to, ‘m’ or ‘multiprocessing’ for multiproessing, ‘s’ or ‘singleprocessing’ for singleprocessing. default ‘m’</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shared_atomic.atomic_string.atomic_string.get_string">
<span class="sig-name descname"><span class="pre">get_string</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#shared_atomic.atomic_string.atomic_string.get_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all the bytes from the string atomically</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>all the bytes in the string</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shared_atomic.atomic_string.atomic_string.reencode">
<span class="sig-name descname"><span class="pre">reencode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">newencode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shared_atomic.atomic_string.atomic_string.reencode" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the encoding of the string, if the original size is not enough,
it will elongate the string, if 7 bytes are not enough, it will fail.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>newencode</strong> – new encoding, such as ‘utf-8’, ‘utf-16-le’</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shared_atomic.atomic_string.atomic_string.resize">
<span class="sig-name descname"><span class="pre">resize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">newlength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paddingdirection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paddingstr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'</span> <span class="pre">'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trimming_direction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'right'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shared_atomic.atomic_string.atomic_string.resize" title="Permalink to this definition">¶</a></dt>
<dd><p>trim or pad the original contents in the string
to a new length, the new length should be no longer than 8 bytes,
the original string wll be replaced with new string, if the original
string is shared between threads/processes, other threads/processes
will wouldn’t be aware of the change, still use the old string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>newlength</strong> – the expected new length of the original bytes.</p></li>
<li><p><strong>paddingdirection</strong> – if longer than original, left or right sidethe original bytes should be padded, by default right side,use ‘right’ or ‘r’ to specify right side, use ‘left’ or ‘l’ to specify the left side.</p></li>
<li><p><strong>paddingstr</strong> – bytes to pad to the original bytes, by default ‘\0’ can be multiple bytes like b’ab’, will be padded to the original bytes in circulation until the expected length is reached.</p></li>
<li><p><strong>trimming_direction</strong> – if shorted than original, left or right side the original bytes should be padded,use ‘right’ or ‘r’ to specify right side,use ‘left’ or ‘l’ to specify the left side.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shared_atomic.atomic_string.atomic_string.set_string">
<span class="sig-name descname"><span class="pre">set_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shared_atomic.atomic_string.atomic_string.set_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the value in the string,
if the new data is longer than the original size of the string.
it will expand the string accordingly which would lose atomicy.
the size of the string can be check with self.size</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – input string</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shared_atomic.atomic_string.atomic_string.string_compare_and_set">
<span class="sig-name descname"><span class="pre">string_compare_and_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#shared_atomic.atomic_string.atomic_string.string_compare_and_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare and set atomically, this compares the contents of self
with the contents of i. If equal, the operation is a read-modify-write
operation that writes n into self. If they are not equal,
the operation is a read and the current contents of itself are written into
i.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – the string to be compared with</p></li>
<li><p><strong>n</strong> – another bytes to be ready to self if comparision return True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>if self is equal to i return True, else return False</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shared_atomic.atomic_string.atomic_string.string_get_and_set">
<span class="sig-name descname"><span class="pre">string_get_and_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#shared_atomic.atomic_string.atomic_string.string_get_and_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Get and set atomically</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – new data</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the original string</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shared_atomic.atomic_string.atomic_string.string_shift">
<span class="sig-name descname"><span class="pre">string_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shared_atomic.atomic_string.atomic_string.string_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Value exchange between 3 pointers in 2 groups atomically,
the initial_length field will be updated but not atomically.
store i in itself after store itself in j</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – one atomic_string</p></li>
<li><p><strong>j</strong> – another atomic_string</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shared_atomic.atomic_string.atomic_string.string_store">
<span class="sig-name descname"><span class="pre">string_store</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shared_atomic.atomic_string.atomic_string.string_store" title="Permalink to this definition">¶</a></dt>
<dd><p>Atomically store contents from another string to the this string,
if the other string is different with this one in size , the function will fail.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>i</strong> – another string to store its value to self</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="shared_atomic.atomic_string.atomic_string.value">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">value</span></span><a class="headerlink" href="#shared_atomic.atomic_string.atomic_string.value" title="Permalink to this definition">¶</a></dt>
<dd><p>same with get_string and set_string</p>
</dd></dl>

</dd></dl>

</div>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="%E5%8E%9F%E5%AD%90%E9%9B%86%E5%90%88API.html" title="Previous document">原子集合API:</a>
        </li>
        <li>
          <a href="CTYPES_API.html" title="Next document">ctypes API 參考</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">shared_atomic</a></h1>



<p class="blurb">多线程多进程共享原子性</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=irvinren&repo=shared_atomic&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="%E5%8E%9F%E5%AD%90API%E7%AF%84%E4%BE%8B.html">原子API範例（多線程多進程混合）:</a></li>
<li class="toctree-l1"><a class="reference internal" href="CTYPES%E7%AF%84%E4%BE%8B.html">ctypes 範例:</a></li>
<li class="toctree-l1"><a class="reference internal" href="%E5%8E%9F%E5%AD%90%E6%9C%89%E7%AC%A6%E8%99%9F%E6%95%B4%E6%95%B8API.html">原子有符號整數API:</a></li>
<li class="toctree-l1"><a class="reference internal" href="%E5%8E%9F%E5%AD%90%E7%84%A1%E7%AC%A6%E8%99%9F%E6%95%B4%E6%95%B8API.html">原子無符號整數API:</a></li>
<li class="toctree-l1"><a class="reference internal" href="%E5%8E%9F%E5%AD%90%E5%B8%83%E7%88%BE%E5%9E%8B%E6%B5%AE%E9%BB%9E%E5%9E%8BAPI.html">原子布爾型浮點型API:</a></li>
<li class="toctree-l1"><a class="reference internal" href="%E5%8E%9F%E5%AD%90%E5%AD%97%E7%AF%80%E6%95%B8%E7%B5%84API.html">原子字節數組API:</a></li>
<li class="toctree-l1"><a class="reference internal" href="%E5%8E%9F%E5%AD%90%E5%88%97%E8%A1%A8API.html">原子列表API:</a></li>
<li class="toctree-l1"><a class="reference internal" href="%E5%8E%9F%E5%AD%90%E9%9B%86%E5%90%88API.html">原子集合API:</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">原子字符串API:</a></li>
<li class="toctree-l1"><a class="reference internal" href="CTYPES_API.html">ctypes API 參考</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="%E5%8E%9F%E5%AD%90%E9%9B%86%E5%90%88API.html" title="previous chapter">原子集合API:</a></li>
      <li>Next: <a href="CTYPES_API.html" title="next chapter">ctypes API 參考</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>


<h3 class="donation">Donate/support</h3>



<p>
<a class="badge" href="https://paypal.me/xiquanren">
<img src="https://img.shields.io/badge/donate-%E2%9D%A4%C2%A0-ff69b4.svg?style=flat" alt="Donate">
</a>
</p>





        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Xiquan Ren <xiquanren@yandex.com>.
      
      |
      <a href="_sources/原子字符串API.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>